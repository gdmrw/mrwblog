<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Spring Boot Software Testing 1, Partitioning and Functioning testing | Mr.W's Blog</title>
<meta name=keywords content="Spring Boot,Java,Actuator"><meta name=description content="Spring Boot is a project under the Spring Framework that simplifies developing, configuring, and deploying Spring-based applications. It promotes convention over configuration by offering pre-configured setups and auto-configuration based on project dependencies, eliminating much of the manual setup and configuration work. Spring Boot applications are stand-alone, containing an embedded web server for easy deployment as a single executable JAR. It offers opinionated defaults to reduce development effort, while still allowing for customization. Features like Actuator provide built-in endpoints for application monitoring and management. Primarily written in Java, Spring Boot supports other JVM languages like Kotlin and Groovy, making it versatile for various enterprise applications. Its goal is to enable quick application startup with less code and configuration hassle."><meta name=author content="Mr.W"><link rel=canonical href=http://localhost:1313/posts/springboottest1/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.c37eecdda64ea639c287617a9bf0cc1589bbc6eb564291c959b6ed3722751621.css integrity="sha256-w37s3aZOpjnCh2F6m/DMFYm7xutWQpHJWbbtNyJ1FiE=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=http://localhost:1313/%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/springboottest1/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=disabled"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","disabled")}</script><meta property="og:url" content="http://localhost:1313/posts/springboottest1/"><meta property="og:site_name" content="Mr.W's Blog"><meta property="og:title" content="Spring Boot Software Testing 1, Partitioning and Functioning testing"><meta property="og:description" content="Spring Boot is a project under the Spring Framework that simplifies developing, configuring, and deploying Spring-based applications. It promotes convention over configuration by offering pre-configured setups and auto-configuration based on project dependencies, eliminating much of the manual setup and configuration work. Spring Boot applications are stand-alone, containing an embedded web server for easy deployment as a single executable JAR. It offers opinionated defaults to reduce development effort, while still allowing for customization. Features like Actuator provide built-in endpoints for application monitoring and management. Primarily written in Java, Spring Boot supports other JVM languages like Kotlin and Groovy, making it versatile for various enterprise applications. Its goal is to enable quick application startup with less code and configuration hassle."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-03-30T00:00:00+00:00"><meta property="article:modified_time" content="2024-03-30T00:00:00+00:00"><meta property="article:tag" content="Spring Boot"><meta property="article:tag" content="Java"><meta property="article:tag" content="Actuator"><meta property="og:image" content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Spring Boot Software Testing 1, Partitioning and Functioning testing"><meta name=twitter:description content="Spring Boot is a project under the Spring Framework that simplifies developing, configuring, and deploying Spring-based applications. It promotes convention over configuration by offering pre-configured setups and auto-configuration based on project dependencies, eliminating much of the manual setup and configuration work. Spring Boot applications are stand-alone, containing an embedded web server for easy deployment as a single executable JAR. It offers opinionated defaults to reduce development effort, while still allowing for customization. Features like Actuator provide built-in endpoints for application monitoring and management. Primarily written in Java, Spring Boot supports other JVM languages like Kotlin and Groovy, making it versatile for various enterprise applications. Its goal is to enable quick application startup with less code and configuration hassle."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"Spring Boot Software Testing 1, Partitioning and Functioning testing","item":"http://localhost:1313/posts/springboottest1/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Spring Boot Software Testing 1, Partitioning and Functioning testing","name":"Spring Boot Software Testing 1, Partitioning and Functioning testing","description":"Spring Boot is a project under the Spring Framework that simplifies developing, configuring, and deploying Spring-based applications. It promotes convention over configuration by offering pre-configured setups and auto-configuration based on project dependencies, eliminating much of the manual setup and configuration work. Spring Boot applications are stand-alone, containing an embedded web server for easy deployment as a single executable JAR. It offers opinionated defaults to reduce development effort, while still allowing for customization. Features like Actuator provide built-in endpoints for application monitoring and management. Primarily written in Java, Spring Boot supports other JVM languages like Kotlin and Groovy, making it versatile for various enterprise applications. Its goal is to enable quick application startup with less code and configuration hassle.\n","keywords":["Spring Boot","Java","Actuator"],"articleBody":"Spring Boot is a project under the Spring Framework that simplifies developing, configuring, and deploying Spring-based applications. It promotes convention over configuration by offering pre-configured setups and auto-configuration based on project dependencies, eliminating much of the manual setup and configuration work. Spring Boot applications are stand-alone, containing an embedded web server for easy deployment as a single executable JAR. It offers opinionated defaults to reduce development effort, while still allowing for customization. Features like Actuator provide built-in endpoints for application monitoring and management. Primarily written in Java, Spring Boot supports other JVM languages like Kotlin and Groovy, making it versatile for various enterprise applications. Its goal is to enable quick application startup with less code and configuration hassle.\nSpring is popular for its numerous advantages: It promotes testable code through its dependency injection method. Offers robust yet user-friendly database transaction management. Facilitates seamless integration with other Java frameworks such as JPA/Hibernate ORM and web frameworks like Struts/JSF. Provides a cutting-edge Web MVC framework for developing web applications. Spring boot size of LOC By using\nfind . -name '*.java' | xargs wc -l You can easily find the specific LOC of Spring boot project The result is 257187 total, I also find some data come from internet about the spring boot LOC in 2020, which you can check below.\nspring-boot-test : 13608 spring-boot-starters : 0 spring-boot-autoconfigure : 69450 spring-boot-docs : 1131 spring-boot-properties-migrator : 548 spring-boot-tools : 33627 spring-boot-cli : 10278 spring-boot-dependencies : 0 spring-boot-test-autoconfigure : 8439 spring-boot-actuator-autoconfigure : 26997 spring-boot-actuator : 27745 spring-boot-parent : 0 spring-boot-devtools : 10912 spring-boot : 61107 Total size of LOC：263842 Testing Spring Boot provides a comprehensive suite of components to facilitate testing for applications built with it. These components simplify the process of writing and executing tests by providing auto-configuration, utility classes, and annotations. Here’s an overview of some of the key testing components and features offered by Spring Boot:\n@SpringBootTest: This annotation is used for integration testing in Spring Boot applications. It loads the complete application context and is useful for testing the interaction between all parts of the application.\n@DataJpaTest: Specifically designed for testing JPA repositories, this annotation configures an in-memory database, scans for @Entity classes, and configures Spring Data JPA repositories. It’s ideal for data access layer testing.\n@WebMvcTest: It is used for testing MVC controllers without starting a full HTTP server. It auto-configures MockMvc for easy testing of controller endpoints.\n@WebFluxTest: Similar to @WebMvcTest, but for applications using Spring WebFlux. It helps in testing annotated controllers in a non-blocking way.\n@RestClientTest: This annotation is useful for testing REST clients. It auto-configures MockRestServiceServer to mock remote REST services.\n@MockBean and @SpyBean: Spring Boot provides these annotations for adding Mockito mocks or spies into the Spring application context. They can be used to replace or spy on beans in the context for unit testing.\nTestRestTemplate and WebTestClient: For integration testing, Spring Boot offers TestRestTemplate for RESTful communication and WebTestClient for testing reactive web applications, making it easier to test web layers.\nJsonPath and XmlPath: For testing RESTful services, Spring Boot supports JsonPath and XmlPath to query and assert the JSON or XML response content.\nAuto-configured Test Databases: Spring Boot can automatically configure an in-memory database for tests, such as H2, which is very convenient for testing data access layers without the need for a real database.\n@TestConfiguration: This annotation helps to define additional beans or customizations for the test context. It allows overriding of certain parts of the application configuration only for tests.\nThese components, among others, provide a robust framework for both unit and integration testing in Spring Boot applications, ensuring that developers can write comprehensive tests with minimal boilerplate code.\nTest cases The spring boot project itself uses a large number of test cases to ensure that all components serve as expected. The following shows the directory structure under the spring boot test folder.\n. ├── spring-boot-integration-tests │ ├── spring-boot-configuration-processor-tests │ ├── spring-boot-launch-script-tests │ ├── spring-boot-loader-classic-tests │ ├── spring-boot-loader-tests │ └── spring-boot-server-tests └── spring-boot-smoke-tests ├── spring-boot-smoke-test-activemq ├── spring-boot-smoke-test-actuator ├── spring-boot-smoke-test-actuator-custom-security ├── spring-boot-smoke-test-actuator-log4j2 ├── spring-boot-smoke-test-actuator-noweb ├── spring-boot-smoke-test-actuator-ui ├── spring-boot-smoke-test-amqp ├── spring-boot-smoke-test-ant ├── spring-boot-smoke-test-aop ├── spring-boot-smoke-test-batch ├── spring-boot-smoke-test-bootstrap-registry ├── spring-boot-smoke-test-cache ├── spring-boot-smoke-test-data-cassandra ├── spring-boot-smoke-test-data-couchbase ├── spring-boot-smoke-test-data-jdbc ├── spring-boot-smoke-test-data-jpa ├── spring-boot-smoke-test-data-ldap ├── spring-boot-smoke-test-data-mongo ├── spring-boot-smoke-test-data-r2dbc ├── spring-boot-smoke-test-data-r2dbc-flyway ├── spring-boot-smoke-test-data-r2dbc-liquibase ├── spring-boot-smoke-test-data-redis ├── spring-boot-smoke-test-data-rest ├── spring-boot-smoke-test-devtools ├── spring-boot-smoke-test-flyway ├── spring-boot-smoke-test-graphql ├── spring-boot-smoke-test-hateoas ├── spring-boot-smoke-test-integration ├── spring-boot-smoke-test-jersey ├── spring-boot-smoke-test-jetty ├── spring-boot-smoke-test-jetty-jsp ├── spring-boot-smoke-test-jetty-ssl ├── spring-boot-smoke-test-jpa ├── spring-boot-smoke-test-junit-vintage ├── spring-boot-smoke-test-kafka ├── spring-boot-smoke-test-liquibase ├── spring-boot-smoke-test-logback ├── spring-boot-smoke-test-oauth2-authorization-server ├── spring-boot-smoke-test-oauth2-client ├── spring-boot-smoke-test-oauth2-resource-server ├── spring-boot-smoke-test-parent-context ├── spring-boot-smoke-test-profile ├── spring-boot-smoke-test-property-validation ├── spring-boot-smoke-test-pulsar ├── spring-boot-smoke-test-quartz ├── spring-boot-smoke-test-reactive-oauth2-client ├── spring-boot-smoke-test-reactive-oauth2-resource-server ├── spring-boot-smoke-test-rsocket ├── spring-boot-smoke-test-saml2-service-provider ├── spring-boot-smoke-test-secure ├── spring-boot-smoke-test-secure-jersey ├── spring-boot-smoke-test-secure-webflux ├── spring-boot-smoke-test-servlet ├── spring-boot-smoke-test-session-hazelcast ├── spring-boot-smoke-test-session-jdbc ├── spring-boot-smoke-test-session-mongo ├── spring-boot-smoke-test-session-redis ├── spring-boot-smoke-test-session-webflux-mongo ├── spring-boot-smoke-test-session-webflux-redis ├── spring-boot-smoke-test-simple ├── spring-boot-smoke-test-test ├── spring-boot-smoke-test-test-nomockito ├── spring-boot-smoke-test-testng ├── spring-boot-smoke-test-tomcat ├── spring-boot-smoke-test-tomcat-jsp ├── spring-boot-smoke-test-tomcat-multi-connectors ├── spring-boot-smoke-test-tomcat-ssl ├── spring-boot-smoke-test-traditional ├── spring-boot-smoke-test-undertow ├── spring-boot-smoke-test-undertow-ssl ├── spring-boot-smoke-test-war ├── spring-boot-smoke-test-web-application-type ├── spring-boot-smoke-test-web-freemarker ├── spring-boot-smoke-test-web-groovy-templates ├── spring-boot-smoke-test-web-jsp ├── spring-boot-smoke-test-web-method-security ├── spring-boot-smoke-test-web-mustache ├── spring-boot-smoke-test-web-secure ├── spring-boot-smoke-test-web-secure-custom ├── spring-boot-smoke-test-web-secure-jdbc ├── spring-boot-smoke-test-web-static ├── spring-boot-smoke-test-web-thymeleaf ├── spring-boot-smoke-test-webflux ├── spring-boot-smoke-test-webflux-coroutines ├── spring-boot-smoke-test-webservices ├── spring-boot-smoke-test-websocket-jetty ├── spring-boot-smoke-test-websocket-tomcat ├── spring-boot-smoke-test-websocket-undertow └── spring-boot-smoke-test-xml Smoke test is an industry testing specification. It is responsible for basic functional testing to ensure that basic functions and processes can work. If and only if the smoke test passes, more detailed tests such as functional testing, integration testing, system testing, etc. will begin, so the smoke test is a good entry point for testing. You can find that spring boot not only tests its own developed components such as actuator, but also conducts detailed tests on other inherited components.We can find some familiar figures in it， like kafka, redis, log4j2 etc.\nRunning the test case Spring boot uses gradle as its automated build tool. To test the entire project, you can simply run:\ngradle clean test Gradle will automatically compile the project and test all existing and not ignored test cases.\nBut if you do that, you will find some funny things happen. You will find one error pop up in the terminal saying there is a failure when build, lets see what it said.\n\u003e Task :spring-boot-project:spring-boot-tools:spring-boot-gradle-plugin:compileTestJava /Users/wjx/Documents/winter quarter/SWE261P/spring test/spring-boot/spring-boot-project/spring-boot-tools/spring-boot-gradle-plugin/src/test/java/org/springframework/boot/gradle/tasks/buildinfo/BuildInfoTests.java:179: error: method loadGradlePropertiesFrom in interface GradlePropertiesController cannot be applied to given types; .loadGradlePropertiesFrom(projectDir); ^ required: File,boolean found: File reason: actual and formal argument lists differ in length 1 error \u003e Task :spring-boot-project:spring-boot-tools:spring-boot-gradle-plugin:compileTestJava FAILED I first double-check to make sure that’s not due to my mistake, I clone the repo again and run the test agian, and the error still exists.\nAccording to the error info, it seems like the method expected to receive 2 params but only get 1, but after I look into the compile test, I found that the design looks correct.\nThe abstract method loadGradlePropertiesFrom is design to input 1 param, and the IDE doesn’t pop up any error. I don’t know why Gradle said expected 2, but it may be some of the Gradle issue since it’d belong to their library.\nBut sometimes you may not want to test the huge system, in most cases, you just want to check the specific function you test. The whole system build obviously not suitable for that—it’s too slow and you need to spend a lot of time just waiting for the result. In this case, I prefer to use the test interface inside the IDE to call the specified test file individually. It will give you greater convenience and help with positioning problems.\nPartitioning and Functioning testing Systematic functional testing and partition testing are crucial for ensuring that a software application is reliable, functions as expected, and meets the users’ needs. They are fundamental components of a thorough and effective software testing strategy.\nIn Functional testing, also known as black box testing, the tester evaluates the software by testing its functions according to the requirements, without any knowledge of the internal workings, structure, or implementation of the application. The focus is on what the system does, not how it does it.\nPartitioning testing, also known as equivalence partitioning, is a technique used in software testing to enhance efficiency and effectiveness by reducing the number of test cases needed to cover all possible input scenarios.\nI found my target test case at:\nspring-boot-tests/spring-boot-smoke-tests/spring-boot-smoke-test-actuator/src/test/java/smoketest/actuator/CorsSampleActuatorApplicationTests.java Let’s check around the existing test case first:\npackage smoketest.actuator; import java.net.URI; import java.util.Map; import org.junit.jupiter.api.BeforeEach; import org.junit.jupiter.api.DisplayName; import org.junit.jupiter.api.Test; import org.springframework.beans.factory.annotation.Autowired; import org.springframework.boot.test.context.SpringBootTest; import org.springframework.boot.test.web.client.LocalHostUriTemplateHandler; import org.springframework.boot.test.web.client.TestRestTemplate; import org.springframework.boot.web.client.RestTemplateBuilder; import org.springframework.context.ApplicationContext; import org.springframework.http.HttpStatus; import org.springframework.http.RequestEntity; import org.springframework.http.ResponseEntity; import org.springframework.test.context.ActiveProfiles; import static org.assertj.core.api.Assertions.assertThat; /** * Integration test for cors preflight requests to management endpoints. * * @author Madhura Bhave */ @SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT) @ActiveProfiles(\"cors\") class CorsSampleActuatorApplicationTests { private TestRestTemplate testRestTemplate; @Autowired private ApplicationContext applicationContext; @BeforeEach void setUp() { RestTemplateBuilder builder = new RestTemplateBuilder(); LocalHostUriTemplateHandler handler = new LocalHostUriTemplateHandler(this.applicationContext.getEnvironment(), \"http\"); builder = builder.uriTemplateHandler(handler); this.testRestTemplate = new TestRestTemplate(builder); } @Test void endpointShouldReturnUnauthorized() { ResponseEntity\u003c?\u003e entity = this.testRestTemplate.getForEntity(\"/actuator/env\", Map.class); assertThat(entity.getStatusCode()).isEqualTo(HttpStatus.UNAUTHORIZED); } @Test void preflightRequestToEndpointShouldReturnOk() throws Exception { RequestEntity\u003c?\u003e healthRequest = RequestEntity.options(new URI(\"/actuator/env\")) .header(\"Origin\", \"http://localhost:8080\") .header(\"Access-Control-Request-Method\", \"GET\") .build(); ResponseEntity\u003c?\u003e exchange = this.testRestTemplate.exchange(healthRequest, Map.class); assertThat(exchange.getStatusCode()).isEqualTo(HttpStatus.OK); } @Test void preflightRequestWhenCorsConfigInvalidShouldReturnForbidden() throws Exception { RequestEntity\u003c?\u003e entity = RequestEntity.options(new URI(\"/actuator/env\")) .header(\"Origin\", \"http://localhost:9095\") .header(\"Access-Control-Request-Method\", \"GET\") .build(); ResponseEntity\u003cbyte[]\u003e exchange = this.testRestTemplate.exchange(entity, byte[].class); assertThat(exchange.getStatusCode()).isEqualTo(HttpStatus.FORBIDDEN); } } The file name told us what this test case doing, the author want to make some test about the spring boot self-build tool, the actuator.\nSpring Boot Actuator provides developers with powerful capabilities to monitor and manage applications. It is one of the indispensable tools for Spring Boot applications in the production environment. And this testing is specifically for testing the actuator endpoint.\nOverall, this java test cross-origin resource sharing (CORS) preflight requests specifically for testing management endpoints (Actuator endpoints). In other words, the main goal is to verify the behavior of the CORS policy on the application’s management endpoint.\nBecause Actuator endpoints can expose sensitive information, it is important to manage the security of these endpoints. In a production environment, it is recommended to restrict access to these endpoints, such as only allowing access from specific IP addresses, or adding authentication through Spring Security.\nYou can see that author use @ActiveProfiles(\"cors\") to make an Simple restrictions on the accessible scope.\nChecking the application-cors.properties file we found that there is two line of rule in the file. They are:\nmanagement.endpoints.web.cors.allowed-origins=http://localhost:8080 management.endpoints.web.cors.allowed-methods=GET Simple and easy to understand, server will only respond to the get request send through http://localhost:8080 others will be forbidden.\nAnd the author tests exactly based on what limitation they set.\nTo simplify, in 3 cases, the author did 3 things.\nTry to get the sensitive end point without any authorization, and expected to get 401 unauthorized response. Try to get the OK response with corret configuration Try to get the forbidden response with incorrect configuration The author leverages two key parameters for enabling the test function: the RESTful API and the port. Both serve as excellent parameters for partitioning. However, for a clearer delineation, the HTTP port is selected as the primary parameter for partition testing.\nIn the realm of computer networking, a port functions as a virtual point where network connections are initiated and terminated. Operating on a software level, ports enable multiple services or applications to listen for and transmit network requests using the same IP address.\nGiven that each port is uniquely identified by its number, within a range from 0 to 65535, this facilitates the creation of boundary-based test cases.\nThis specific range allows for the straightforward determination of the minimum and maximum port boundaries, which are 0 and 65535, respectively. Utilizing this information, one can devise a test case to ascertain whether the endpoint’s limit policy is adept at managing boundary events.\nAdditionally, a test case has been crafted to evaluate how the endpoint policy copes with non-existent ports, thereby assessing its effectiveness in handling cases that fall outside the defined bounds.\nThe specific code implementation is as follows：\n@Test @DisplayName(\"port boundary test, maximum\") void preflightRequestPortBoundaryTestWhenCorsConfigInvalidShouldReturnForbidden() throws Exception { RequestEntity\u003c?\u003e entity = RequestEntity.options(new URI(\"/actuator/env\")) .header(\"Origin\", \"http://localhost:65535\") .header(\"Access-Control-Request-Method\", \"GET\") .build(); ResponseEntity\u003cbyte[]\u003e exchange = this.testRestTemplate.exchange(entity, byte[].class); assertThat(exchange.getStatusCode()).isEqualTo(HttpStatus.FORBIDDEN); } @Test @DisplayName(\"port boundary test2, minimum\") void preflightRequestPortBoundaryTest2WhenCorsConfigInvalidShouldReturnForbidden() throws Exception { RequestEntity\u003c?\u003e entity = RequestEntity.options(new URI(\"/actuator/env\")) .header(\"Origin\", \"http://localhost:0\") .header(\"Access-Control-Request-Method\", \"GET\") .build(); ResponseEntity\u003cbyte[]\u003e exchange = this.testRestTemplate.exchange(entity, byte[].class); assertThat(exchange.getStatusCode()).isEqualTo(HttpStatus.FORBIDDEN); } @Test @DisplayName(\"port boundary test3， out of bound\") void preflightRequestPortBoundaryTest3WhenCorsConfigInvalidShouldReturnForbidden() throws Exception { RequestEntity\u003c?\u003e entity = RequestEntity.options(new URI(\"/actuator/env\")) .header(\"Origin\", \"http://localhost:99999\") .header(\"Access-Control-Request-Method\", \"GET\") .build(); ResponseEntity\u003cbyte[]\u003e exchange = this.testRestTemplate.exchange(entity, byte[].class); assertThat(exchange.getStatusCode()).isEqualTo(HttpStatus.FORBIDDEN); } Run the test case,all test cases pass as expected\n","wordCount":"2050","inLanguage":"en","image":"http://localhost:1313/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E","datePublished":"2024-03-30T00:00:00Z","dateModified":"2024-03-30T00:00:00Z","author":{"@type":"Person","name":"Mr.W"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/springboottest1/"},"publisher":{"@type":"Organization","name":"Mr.W's Blog","logo":{"@type":"ImageObject","url":"http://localhost:1313/%3Clink%20/%20abs%20url%3E"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="Home (Alt + H)"><img src=http://localhost:1313/apple-touch-icon.png alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/archives/ title=Archieves><span>Archieves</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=http://localhost:1313/archive/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">Spring Boot Software Testing 1, Partitioning and Functioning testing</h1><div class=post-meta><span title='2024-03-30 00:00:00 +0000 UTC'>March 30, 2024</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp;2050 words&nbsp;·&nbsp;Mr.W</div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><ul><ul><li><a href=#spring-is-popular-for-its-numerous-advantages aria-label="Spring is popular for its numerous advantages:">Spring is popular for its numerous advantages:</a></li><li><a href=#spring-boot-size-of-loc aria-label="Spring boot size of LOC">Spring boot size of LOC</a></li></ul></ul><li><a href=#testing aria-label=Testing>Testing</a><ul><li><a href=#test-cases aria-label="Test cases">Test cases</a></li><li><a href=#running-the-test-case aria-label="Running the test case">Running the test case</a></li></ul></li><li><a href=#partitioning-and-functioning-testing aria-label="Partitioning and Functioning testing">Partitioning and Functioning testing</a></li></ul></div></details></div><div class=post-content><p>Spring Boot is a project under the Spring Framework that simplifies developing, configuring, and deploying Spring-based applications. It promotes convention over configuration by offering pre-configured setups and auto-configuration based on project dependencies, eliminating much of the manual setup and configuration work. Spring Boot applications are stand-alone, containing an embedded web server for easy deployment as a single executable JAR. It offers opinionated defaults to reduce development effort, while still allowing for customization. Features like Actuator provide built-in endpoints for application monitoring and management. Primarily written in Java, Spring Boot supports other JVM languages like Kotlin and Groovy, making it versatile for various enterprise applications. Its goal is to enable quick application startup with less code and configuration hassle.</p><h4 id=spring-is-popular-for-its-numerous-advantages>Spring is popular for its numerous advantages:<a hidden class=anchor aria-hidden=true href=#spring-is-popular-for-its-numerous-advantages>#</a></h4><ul><li>It promotes testable code through its dependency injection method.</li><li>Offers robust yet user-friendly database transaction management.</li><li>Facilitates seamless integration with other Java frameworks such as JPA/Hibernate ORM and web frameworks like Struts/JSF.</li><li>Provides a cutting-edge Web MVC framework for developing web applications.</li></ul><h4 id=spring-boot-size-of-loc>Spring boot size of LOC<a hidden class=anchor aria-hidden=true href=#spring-boot-size-of-loc>#</a></h4><p>By using</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>find . -name <span class=s1>&#39;*.java&#39;</span> <span class=p>|</span> xargs wc -l
</span></span></code></pre></div><p>You can easily find the specific LOC of Spring boot project
The result is <code>257187 total</code>, I also find some data come from internet about the spring boot LOC in 2020, which you can check below.</p><pre tabindex=0><code>spring-boot-test : 13608
spring-boot-starters : 0
spring-boot-autoconfigure : 69450
spring-boot-docs : 1131
spring-boot-properties-migrator : 548
spring-boot-tools : 33627
spring-boot-cli : 10278
spring-boot-dependencies : 0
spring-boot-test-autoconfigure : 8439
spring-boot-actuator-autoconfigure : 26997
spring-boot-actuator : 27745
spring-boot-parent : 0
spring-boot-devtools : 10912
spring-boot : 61107
 
Total size of LOC：263842
</code></pre><hr><h2 id=testing>Testing<a hidden class=anchor aria-hidden=true href=#testing>#</a></h2><p>Spring Boot provides a comprehensive suite of components to facilitate testing for applications built with it. These components simplify the process of writing and executing tests by providing auto-configuration, utility classes, and annotations. Here&rsquo;s an overview of some of the key testing components and features offered by Spring Boot:</p><ol><li><p><strong>@SpringBootTest</strong>: This annotation is used for integration testing in Spring Boot applications. It loads the complete application context and is useful for testing the interaction between all parts of the application.</p></li><li><p><strong>@DataJpaTest</strong>: Specifically designed for testing JPA repositories, this annotation configures an in-memory database, scans for <strong>@Entity</strong> classes, and configures Spring Data JPA repositories. It&rsquo;s ideal for data access layer testing.</p></li><li><p><strong>@WebMvcTest</strong>: It is used for testing MVC controllers without starting a full HTTP server. It auto-configures <strong>MockMvc</strong> for easy testing of controller endpoints.</p></li><li><p><strong>@WebFluxTest</strong>: Similar to <strong>@WebMvcTest</strong>, but for applications using Spring WebFlux. It helps in testing annotated controllers in a non-blocking way.</p></li><li><p><strong>@RestClientTest</strong>: This annotation is useful for testing REST clients. It auto-configures <strong>MockRestServiceServer</strong> to mock remote REST services.</p></li><li><p><strong>@MockBean</strong> and <strong>@SpyBean</strong>: Spring Boot provides these annotations for adding <code>Mockito</code> mocks or spies into the Spring application context. They can be used to replace or spy on beans in the context for unit testing.</p></li><li><p><strong>TestRestTemplate</strong> and <strong>WebTestClient</strong>: For integration testing, Spring Boot offers <code>TestRestTemplate</code> for RESTful communication and <code>WebTestClient</code> for testing reactive web applications, making it easier to test web layers.</p></li><li><p><strong>JsonPath</strong> and <strong>XmlPath</strong>: For testing RESTful services, Spring Boot supports JsonPath and XmlPath to query and assert the JSON or XML response content.</p></li><li><p><strong>Auto-configured Test Databases</strong>: Spring Boot can automatically configure an in-memory database for tests, such as H2, which is very convenient for testing data access layers without the need for a real database.</p></li><li><p><strong>@TestConfiguration</strong>: This annotation helps to define additional beans or customizations for the test context. It allows overriding of certain parts of the application configuration only for tests.</p></li></ol><p>These components, among others, provide a robust framework for both unit and integration testing in Spring Boot applications, ensuring that developers can write comprehensive tests with minimal boilerplate code.</p><h3 id=test-cases>Test cases<a hidden class=anchor aria-hidden=true href=#test-cases>#</a></h3><p>The spring boot project itself uses a large number of test cases to ensure that all components serve as expected. The following shows the directory structure under the spring boot test folder.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>.
</span></span><span class=line><span class=cl>├── spring-boot-integration-tests
</span></span><span class=line><span class=cl>│   ├── spring-boot-configuration-processor-tests
</span></span><span class=line><span class=cl>│   ├── spring-boot-launch-script-tests
</span></span><span class=line><span class=cl>│   ├── spring-boot-loader-classic-tests
</span></span><span class=line><span class=cl>│   ├── spring-boot-loader-tests
</span></span><span class=line><span class=cl>│   └── spring-boot-server-tests
</span></span><span class=line><span class=cl>└── spring-boot-smoke-tests
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-activemq
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-actuator
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-actuator-custom-security
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-actuator-log4j2
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-actuator-noweb
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-actuator-ui
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-amqp
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-ant
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-aop
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-batch
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-bootstrap-registry
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-cache
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-cassandra
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-couchbase
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-jdbc
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-jpa
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-ldap
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-mongo
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-r2dbc
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-r2dbc-flyway
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-r2dbc-liquibase
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-redis
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-data-rest
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-devtools
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-flyway
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-graphql
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-hateoas
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-integration
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-jersey
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-jetty
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-jetty-jsp
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-jetty-ssl
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-jpa
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-junit-vintage
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-kafka
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-liquibase
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-logback
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-oauth2-authorization-server
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-oauth2-client
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-oauth2-resource-server
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-parent-context
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-profile
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-property-validation
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-pulsar
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-quartz
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-reactive-oauth2-client
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-reactive-oauth2-resource-server
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-rsocket
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-saml2-service-provider
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-secure
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-secure-jersey
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-secure-webflux
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-servlet
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-session-hazelcast
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-session-jdbc
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-session-mongo
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-session-redis
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-session-webflux-mongo
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-session-webflux-redis
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-simple
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-test
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-test-nomockito
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-testng
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-tomcat
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-tomcat-jsp
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-tomcat-multi-connectors
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-tomcat-ssl
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-traditional
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-undertow
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-undertow-ssl
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-war
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-application-type
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-freemarker
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-groovy-templates
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-jsp
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-method-security
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-mustache
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-secure
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-secure-custom
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-secure-jdbc
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-static
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-web-thymeleaf
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-webflux
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-webflux-coroutines
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-webservices
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-websocket-jetty
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-websocket-tomcat
</span></span><span class=line><span class=cl>    ├── spring-boot-smoke-test-websocket-undertow
</span></span><span class=line><span class=cl>    └── spring-boot-smoke-test-xml
</span></span></code></pre></div><p>Smoke test is an industry testing specification. It is responsible for basic functional testing to ensure that basic functions and processes can work. If and only if the smoke test passes, more detailed tests such as functional testing, integration testing, system testing, etc. will begin, so the smoke test is a good entry point for testing.
You can find that spring boot not only tests its own developed components such as actuator, but also conducts detailed tests on other inherited components.We can find some familiar figures in it， like <code>kafka</code>, <code>redis</code>, <code>log4j2</code> etc.</p><h3 id=running-the-test-case>Running the test case<a hidden class=anchor aria-hidden=true href=#running-the-test-case>#</a></h3><p>Spring boot uses gradle as its automated build tool. To test the entire project, you can simply run:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>gradle clean <span class=nb>test</span>
</span></span></code></pre></div><p>Gradle will automatically compile the project and test all existing and not ignored test cases.</p><p>But if you do that, you will find some funny things happen.
You will find one error pop up in the terminal saying there is a failure when build, lets see what it said.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>&gt; Task :spring-boot-project:spring-boot-tools:spring-boot-gradle-plugin:compileTestJava
</span></span><span class=line><span class=cl>/Users/wjx/Documents/winter quarter/SWE261P/spring test/spring-boot/spring-boot-project/spring-boot-tools/spring-boot-gradle-plugin/src/test/java/org/springframework/boot/gradle/tasks/buildinfo/BuildInfoTests.java:179: error: method loadGradlePropertiesFrom in interface GradlePropertiesController cannot be applied to given types<span class=p>;</span>
</span></span><span class=line><span class=cl>                        .loadGradlePropertiesFrom<span class=o>(</span>projectDir<span class=o>)</span><span class=p>;</span>
</span></span><span class=line><span class=cl>                        ^
</span></span><span class=line><span class=cl>  required: File,boolean
</span></span><span class=line><span class=cl>  found:    File
</span></span><span class=line><span class=cl>  reason: actual and formal argument lists differ in length
</span></span><span class=line><span class=cl><span class=m>1</span> error
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>&gt; Task :spring-boot-project:spring-boot-tools:spring-boot-gradle-plugin:compileTestJava FAILED
</span></span></code></pre></div><p>I first double-check to make sure that&rsquo;s not due to my mistake, I clone the repo again and run the test agian, and the error still exists.</p><p>According to the error info, it seems like the method expected to receive 2 params but only get 1, but after I look into the <code>compile test</code>, I found that the design looks correct.</p><p><img loading=lazy src=screen-shot-build-error.png></p><p>The abstract method <code>loadGradlePropertiesFrom</code> is design to input 1 param, and the IDE doesn&rsquo;t pop up any error. I don&rsquo;t know why Gradle said expected 2, but it may be some of the Gradle issue since it&rsquo;d belong to their library.</p><hr><p>But sometimes you may not want to test the huge system, in most cases, you just want to check the specific function you test. The whole system build obviously not suitable for that—it&rsquo;s too slow and you need to spend a lot of time just waiting for the result. In this case, I prefer to use the test interface inside the IDE to call the specified test file individually. It will give you greater convenience and help with positioning problems.</p><h2 id=partitioning-and-functioning-testing>Partitioning and Functioning testing<a hidden class=anchor aria-hidden=true href=#partitioning-and-functioning-testing>#</a></h2><p>Systematic functional testing and partition testing are crucial for ensuring that a software application is reliable, functions as expected, and meets the users&rsquo; needs. They are fundamental components of a thorough and effective software testing strategy.</p><p>In Functional testing, also known as black box testing, the tester evaluates the software by testing its functions according to the requirements, without any knowledge of the internal workings, structure, or implementation of the application. The focus is on what the system does, not how it does it.</p><p>Partitioning testing, also known as equivalence partitioning, is a technique used in software testing to enhance efficiency and effectiveness by reducing the number of test cases needed to cover all possible input scenarios.</p><hr><p>I found my target test case at:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>spring-boot-tests/spring-boot-smoke-tests/spring-boot-smoke-test-actuator/src/test/java/smoketest/actuator/CorsSampleActuatorApplicationTests.java
</span></span></code></pre></div><p>Let&rsquo;s check around the existing test case first:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>package</span><span class=w> </span><span class=nn>smoketest.actuator</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.net.URI</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>java.util.Map</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.junit.jupiter.api.BeforeEach</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.junit.jupiter.api.DisplayName</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.junit.jupiter.api.Test</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.beans.factory.annotation.Autowired</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.test.context.SpringBootTest</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.test.web.client.LocalHostUriTemplateHandler</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.test.web.client.TestRestTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.boot.web.client.RestTemplateBuilder</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.context.ApplicationContext</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.http.HttpStatus</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.http.RequestEntity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.http.ResponseEntity</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import</span><span class=w> </span><span class=nn>org.springframework.test.context.ActiveProfiles</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kn>import static</span><span class=w> </span><span class=nn>org.assertj.core.api.Assertions.assertThat</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=cm>/**
</span></span></span><span class=line><span class=cl><span class=cm> * Integration test for cors preflight requests to management endpoints.
</span></span></span><span class=line><span class=cl><span class=cm> *
</span></span></span><span class=line><span class=cl><span class=cm> * @author Madhura Bhave
</span></span></span><span class=line><span class=cl><span class=cm> */</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@SpringBootTest</span><span class=p>(</span><span class=n>webEnvironment</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>SpringBootTest</span><span class=p>.</span><span class=na>WebEnvironment</span><span class=p>.</span><span class=na>RANDOM_PORT</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=nd>@ActiveProfiles</span><span class=p>(</span><span class=s>&#34;cors&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=kd>class</span> <span class=nc>CorsSampleActuatorApplicationTests</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>TestRestTemplate</span><span class=w> </span><span class=n>testRestTemplate</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Autowired</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kd>private</span><span class=w> </span><span class=n>ApplicationContext</span><span class=w> </span><span class=n>applicationContext</span><span class=p>;</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@BeforeEach</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kt>void</span><span class=w> </span><span class=nf>setUp</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>RestTemplateBuilder</span><span class=w> </span><span class=n>builder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>RestTemplateBuilder</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>LocalHostUriTemplateHandler</span><span class=w> </span><span class=n>handler</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>LocalHostUriTemplateHandler</span><span class=p>(</span><span class=k>this</span><span class=p>.</span><span class=na>applicationContext</span><span class=p>.</span><span class=na>getEnvironment</span><span class=p>(),</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=s>&#34;http&#34;</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>builder</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>builder</span><span class=p>.</span><span class=na>uriTemplateHandler</span><span class=p>(</span><span class=n>handler</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=k>this</span><span class=p>.</span><span class=na>testRestTemplate</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>new</span><span class=w> </span><span class=n>TestRestTemplate</span><span class=p>(</span><span class=n>builder</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kt>void</span><span class=w> </span><span class=nf>endpointShouldReturnUnauthorized</span><span class=p>()</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>ResponseEntity</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>entity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>testRestTemplate</span><span class=p>.</span><span class=na>getForEntity</span><span class=p>(</span><span class=s>&#34;/actuator/env&#34;</span><span class=p>,</span><span class=w> </span><span class=n>Map</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>assertThat</span><span class=p>(</span><span class=n>entity</span><span class=p>.</span><span class=na>getStatusCode</span><span class=p>()).</span><span class=na>isEqualTo</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>UNAUTHORIZED</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kt>void</span><span class=w> </span><span class=nf>preflightRequestToEndpointShouldReturnOk</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>RequestEntity</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>healthRequest</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestEntity</span><span class=p>.</span><span class=na>options</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>URI</span><span class=p>(</span><span class=s>&#34;/actuator/env&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Origin&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;http://localhost:8080&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Access-Control-Request-Method&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;GET&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>ResponseEntity</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>exchange</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>testRestTemplate</span><span class=p>.</span><span class=na>exchange</span><span class=p>(</span><span class=n>healthRequest</span><span class=p>,</span><span class=w> </span><span class=n>Map</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>assertThat</span><span class=p>(</span><span class=n>exchange</span><span class=p>.</span><span class=na>getStatusCode</span><span class=p>()).</span><span class=na>isEqualTo</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>OK</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kt>void</span><span class=w> </span><span class=nf>preflightRequestWhenCorsConfigInvalidShouldReturnForbidden</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>RequestEntity</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>entity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestEntity</span><span class=p>.</span><span class=na>options</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>URI</span><span class=p>(</span><span class=s>&#34;/actuator/env&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Origin&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;http://localhost:9095&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Access-Control-Request-Method&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;GET&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=kt>byte</span><span class=o>[]&gt;</span><span class=w> </span><span class=n>exchange</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>testRestTemplate</span><span class=p>.</span><span class=na>exchange</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=kt>byte</span><span class=o>[]</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>assertThat</span><span class=p>(</span><span class=n>exchange</span><span class=p>.</span><span class=na>getStatusCode</span><span class=p>()).</span><span class=na>isEqualTo</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>FORBIDDEN</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w></span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>The file name told us what this test case doing, the author want to make some test about the spring boot self-build tool, the <code>actuator</code>.</p><p>Spring Boot Actuator provides developers with powerful capabilities to monitor and manage applications. It is one of the indispensable tools for Spring Boot applications in the production environment. And this testing is specifically for testing the actuator endpoint.</p><p>Overall, this java test cross-origin resource sharing (CORS) preflight requests specifically for testing management endpoints (Actuator endpoints). In other words, the main goal is to verify the behavior of the CORS policy on the application&rsquo;s management endpoint.</p><p>Because Actuator endpoints can expose sensitive information, it is important to manage the security of these endpoints. In a production environment, it is recommended to restrict access to these endpoints, such as only allowing access from specific IP addresses, or adding authentication through Spring Security.</p><p>You can see that author use <code>@ActiveProfiles("cors") </code>to make an Simple restrictions on the accessible scope.</p><p>Checking the <code>application-cors.properties</code> file we found that there is two line of rule in the file. They are:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-properties data-lang=properties><span class=line><span class=cl><span class=na>management.endpoints.web.cors.allowed-origins</span><span class=o>=</span><span class=s>http://localhost:8080</span>
</span></span><span class=line><span class=cl><span class=na>management.endpoints.web.cors.allowed-methods</span><span class=o>=</span><span class=s>GET</span>
</span></span></code></pre></div><p>Simple and easy to understand, server will only respond to the <code>get</code> request send through <code>http://localhost:8080</code> others will be forbidden.</p><p>And the author tests exactly based on what limitation they set.</p><p>To simplify, in 3 cases, the author did 3 things.</p><ol><li>Try to get the sensitive end point without any authorization, and expected to get <code>401 unauthorized</code> response.</li><li>Try to get the <code>OK</code> response with corret configuration</li><li>Try to get the <code>forbidden</code> response with incorrect configuration</li></ol><p>The author leverages two key parameters for enabling the test function: the <code>RESTful API</code> and the <code>port</code>. Both serve as excellent parameters for partitioning. However, for a clearer delineation, the HTTP port is selected as the primary parameter for partition testing.</p><p>In the realm of computer networking, a <code>port</code> functions as a virtual point where network connections are initiated and terminated. Operating on a software level, ports enable multiple services or applications to listen for and transmit network requests using the same IP address.</p><p>Given that each port is uniquely identified by its number, within a range from 0 to 65535, this facilitates the creation of boundary-based test cases.</p><p>This specific range allows for the straightforward determination of the minimum and maximum port boundaries, which are 0 and 65535, respectively. Utilizing this information, one can devise a test case to ascertain whether the endpoint&rsquo;s limit policy is adept at managing boundary events.</p><p>Additionally, a test case has been crafted to evaluate how the endpoint policy copes with non-existent ports, thereby assessing its effectiveness in handling cases that fall outside the defined bounds.</p><p>The specific code implementation is as follows：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@DisplayName</span><span class=p>(</span><span class=s>&#34;port boundary test, maximum&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kt>void</span><span class=w> </span><span class=nf>preflightRequestPortBoundaryTestWhenCorsConfigInvalidShouldReturnForbidden</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>RequestEntity</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>entity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestEntity</span><span class=p>.</span><span class=na>options</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>URI</span><span class=p>(</span><span class=s>&#34;/actuator/env&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Origin&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;http://localhost:65535&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Access-Control-Request-Method&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;GET&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=kt>byte</span><span class=o>[]&gt;</span><span class=w> </span><span class=n>exchange</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>testRestTemplate</span><span class=p>.</span><span class=na>exchange</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=kt>byte</span><span class=o>[]</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>assertThat</span><span class=p>(</span><span class=n>exchange</span><span class=p>.</span><span class=na>getStatusCode</span><span class=p>()).</span><span class=na>isEqualTo</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>FORBIDDEN</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@DisplayName</span><span class=p>(</span><span class=s>&#34;port boundary test2, minimum&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kt>void</span><span class=w> </span><span class=nf>preflightRequestPortBoundaryTest2WhenCorsConfigInvalidShouldReturnForbidden</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>RequestEntity</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>entity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestEntity</span><span class=p>.</span><span class=na>options</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>URI</span><span class=p>(</span><span class=s>&#34;/actuator/env&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Origin&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;http://localhost:0&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Access-Control-Request-Method&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;GET&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=kt>byte</span><span class=o>[]&gt;</span><span class=w> </span><span class=n>exchange</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>testRestTemplate</span><span class=p>.</span><span class=na>exchange</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=kt>byte</span><span class=o>[]</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>assertThat</span><span class=p>(</span><span class=n>exchange</span><span class=p>.</span><span class=na>getStatusCode</span><span class=p>()).</span><span class=na>isEqualTo</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>FORBIDDEN</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@Test</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=nd>@DisplayName</span><span class=p>(</span><span class=s>&#34;port boundary test3， out of bound&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=kt>void</span><span class=w> </span><span class=nf>preflightRequestPortBoundaryTest3WhenCorsConfigInvalidShouldReturnForbidden</span><span class=p>()</span><span class=w> </span><span class=kd>throws</span><span class=w> </span><span class=n>Exception</span><span class=w> </span><span class=p>{</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>RequestEntity</span><span class=o>&lt;?&gt;</span><span class=w> </span><span class=n>entity</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=n>RequestEntity</span><span class=p>.</span><span class=na>options</span><span class=p>(</span><span class=k>new</span><span class=w> </span><span class=n>URI</span><span class=p>(</span><span class=s>&#34;/actuator/env&#34;</span><span class=p>))</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Origin&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;http://localhost:99999&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>header</span><span class=p>(</span><span class=s>&#34;Access-Control-Request-Method&#34;</span><span class=p>,</span><span class=w> </span><span class=s>&#34;GET&#34;</span><span class=p>)</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>				</span><span class=p>.</span><span class=na>build</span><span class=p>();</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>ResponseEntity</span><span class=o>&lt;</span><span class=kt>byte</span><span class=o>[]&gt;</span><span class=w> </span><span class=n>exchange</span><span class=w> </span><span class=o>=</span><span class=w> </span><span class=k>this</span><span class=p>.</span><span class=na>testRestTemplate</span><span class=p>.</span><span class=na>exchange</span><span class=p>(</span><span class=n>entity</span><span class=p>,</span><span class=w> </span><span class=kt>byte</span><span class=o>[]</span><span class=p>.</span><span class=na>class</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>		</span><span class=n>assertThat</span><span class=p>(</span><span class=n>exchange</span><span class=p>.</span><span class=na>getStatusCode</span><span class=p>()).</span><span class=na>isEqualTo</span><span class=p>(</span><span class=n>HttpStatus</span><span class=p>.</span><span class=na>FORBIDDEN</span><span class=p>);</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>	</span><span class=p>}</span><span class=w>
</span></span></span></code></pre></div><p>Run the test case,all test cases pass as expected</p><p><img loading=lazy src=/posts/springboottest1/build-success.png></p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/spring-boot/>Spring Boot</a></li><li><a href=http://localhost:1313/tags/java/>Java</a></li><li><a href=http://localhost:1313/tags/actuator/>Actuator</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/springboottest2/><span class=title>« Prev</span><br><span>Spring Boot Software Testing 2 - Actuator - Finite State Machine</span>
</a><a class=next href=http://localhost:1313/posts/scroll-offset-client/><span class=title>Next »</span><br><span>Size measurement parameters -- client, offset and scroll</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2024 <a href=http://localhost:1313/>Mr.W's Blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>